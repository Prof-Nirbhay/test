<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Practical Exam Question Paper Generator</title>

<style>
body {
    font-family: "Times New Roman", Times, serif;
    background:#f4f6f8;
    padding:20px;
}

.container {
    max-width: 900px;
    margin:auto;
    background:#fff;
    padding:20px;
    border-radius:8px;
    box-shadow:0 4px 12px rgba(0,0,0,0.1);
}

h2 {
    text-align:center;
    margin-bottom:20px;
}

label {
    font-weight:bold;
}

input, textarea, select, button {
    width:100%;
    font-family:"Times New Roman", Times, serif;
    font-size:12pt;
    margin-bottom:10px;
    padding:6px;
}

button {
    cursor:pointer;
    font-weight:bold;
}

.actions {
    display:flex;
    gap:10px;
}

.actions button {
    flex:1;
}

.preview-box {
    margin-top:20px;
    border:1px solid #ccc;
    padding:10px;
    background:#fff;
}

iframe {
    width:100%;
    height:600px;
    border:none;
}

/* ===== WORD / PRINT STYLES ===== */
.word {
    font-family:"Times New Roman", Times, serif;
    font-size:12pt;
    font-weight:bold;
}

.word table {
    width:100%;
    border-collapse:collapse;
}

.word td {
    padding:6px;
    vertical-align:top;
}

.center {
    text-align:center;
}

.qno {
    width:60px;
    text-align:center;
}

.marks {
    width:60px;
    text-align:center;
}
</style>
</head>

<body>

<div class="container">

<h2>Practical Exam Question Paper Generator</h2>

<label>College Logo (URL):</label>
<input type="text" id="logo" placeholder="Paste logo image URL (optional)">

<label>Department Name:</label>
<input type="text" id="dept" placeholder="Department of Computer Science">

<label>Class:</label>
<select id="class">
    <option>FYBSc CS AIML</option>
    <option>SYBSc CS AIML</option>
    <option>TYBSc CS AIML</option>
    <option>FYBSc CS CTIS</option>
    <option>SYBSc CS CTIS</option>
    <option>TYBSc CS CTIS</option>
    <option>FYMSc CS</option>
    <option>SYMSc CS</option>
    <option>FYMSc CS (CYBER)</option>
    <option>SYMSc CS (CYBER)</option>
</select>

<label>Semester:</label>
<select id="semester">
    <option>I</option><option>II</option><option>III</option>
    <option>IV</option><option>V</option><option>VI</option>
</select>

<label>Subject Name:</label>
<input type="text" id="subject">

<label>Questions (one per line):</label>
<textarea id="questions" rows="6"></textarea>

<div class="actions">
    <button onclick="showPreview()">Preview</button>
    <button onclick="downloadDoc()">Download Word</button>
    <button onclick="printPaper()">Print</button>
</div>

<div class="preview-box">
    <iframe id="preview"></iframe>
</div>

</div>

<script>
function buildHTML() {
    const logo = document.getElementById("logo").value.trim();
    const dept = document.getElementById("dept").value.trim();
    const cls = document.getElementById("class").value;
    const sem = document.getElementById("semester").value;
    const subject = document.getElementById("subject").value.trim();

    const qs = document.getElementById("questions").value
        .split(/\r?\n/)
        .map(q => q.trim())
        .filter(q => q);

    if (!subject || qs.length < 2) {
        alert("Enter subject name and at least two questions.");
        return "";
    }

    let header = `
    <div class="center">
        ${logo ? `<img src="${logo}" style="height:80px;"><br><br>` : ""}
        <b>
        NAGINDAS KHANDWALA COLLEGE, MALAD(W)<br>
        (Autonomous)<br><br>
        ${cls} SEM ${sem} PRACTICAL EXAMINATION FEBRUARY- 2026
        </b>
        ${dept ? `<br><br>${dept}` : ""}
    </div>
    <br>
    `;

    let body = ``;

    for (let i = 0; i < qs.length; i++) {
        for (let j = i + 1; j < qs.length; j++) {

            body += `
            <div class="word">
            ${header}

            <table>
            <tr>
                <td>Time: 2 Hours</td>
                <td class="center"></td>
                <td class="center">Roll No: __________</td>
            </tr>
            <tr>
                <td>Course: ${subject}</td>
                <td></td>
                <td class="center">Marks: 50</td>
            </tr>
            </table>

            <br>

            <table>
            <tr>
                <td class="qno">Q1</td>
                <td>${qs[i]}</td>
                <td class="marks">20</td>
            </tr>
            <tr>
                <td class="qno">Q2</td>
                <td>${qs[j]}</td>
                <td class="marks">20</td>
            </tr>
            <tr>
                <td class="qno">Q3</td>
                <td>VIVA</td>
                <td class="marks">05</td>
            </tr>
            <tr>
                <td class="qno">Q4</td>
                <td>JOURNAL</td>
                <td class="marks">05</td>
            </tr>
            </table>
            </div>

            <br><br><br><br>
            `;
        }
    }

    return `
    <html>
    <head><meta charset="UTF-8"></head>
    <body>${body}</body>
    </html>
    `;
}

function showPreview() {
    const html = buildHTML();
    if (!html) return;
    const iframe = document.getElementById("preview");
    iframe.srcdoc = html;
}

function downloadDoc() {
    const html = buildHTML();
    if (!html) return;

    const subject = document.getElementById("subject").value;
    const fileName = subject.replace(/[\\/:*?"<>|]/g, "");

    const blob = new Blob([html], { type: "application/msword" });
    const url = URL.createObjectURL(blob);

    const a = document.createElement("a");
    a.href = url;
    a.download = fileName + ".doc";
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    URL.revokeObjectURL(url);
}

function printPaper() {
    const html = buildHTML();
    if (!html) return;

    const win = window.open("", "", "width=900,height=700");
    win.document.write(html);
    win.document.close();
    win.focus();
    win.print();
}
</script>

</body>
</html>
