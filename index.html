<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>PracGenWeb</title>

<style>
body{
    font-family:"Times New Roman", Times, serif;
    background:#eef1f5;
    margin:0;
    padding:0;
}

.container{
    max-width:900px;
    margin:30px auto;
    background:#fff;
    padding:25px;
    border-radius:8px;
    box-shadow:0 4px 12px rgba(0,0,0,0.15);
}

.header{
    display:flex;
    align-items:center;
    gap:15px;
    border-bottom:2px solid #1f4fd8;
    padding-bottom:10px;
    margin-bottom:15px;
}

.header img{
    height:70px;
}

.header-text{
    text-align:center;
    flex:1;
}

.header-text h2{
    margin:0;
    font-size:20px;
}

.header-text h4{
    margin:4px 0 0;
    font-weight:normal;
}

label{
    font-weight:bold;
    display:block;
    margin-top:10px;
}

input, textarea, select{
    width:100%;
    padding:6px;
    font-family:"Times New Roman", Times, serif;
    font-size:12pt;
    margin-top:4px;
}

.actions{
    display:flex;
    justify-content:center;
    gap:15px;
    margin-top:20px;
}

button{
    padding:8px 18px;
    font-family:"Times New Roman", Times, serif;
    font-size:12pt;
    border:none;
    border-radius:4px;
    cursor:pointer;
    background:#1f4fd8;
    color:#fff;
}

button:hover{
    background:#163bb3;
}

/* PREVIEW MODAL */
.modal{
    display:none;
    position:fixed;
    inset:0;
    background:rgba(0,0,0,0.6);
    z-index:1000;
}

.modal-box{
    background:#fff;
    width:90%;
    max-width:950px;
    margin:30px auto;
    padding:15px;
}

.modal-actions{
    text-align:right;
    margin-bottom:8px;
}

.modal-actions button{
    margin-left:6px;
}

iframe{
    width:100%;
    height:600px;
    border:1px solid #000;
}
</style>
</head>

<body>

<div class="container">

<div class="header">
    <img src="college_logo.png" alt="College Logo">
    <div class="header-text">
        <h2>Practical Exam Question Paper Generator</h2>
        <h4>DEPARTMENT OF ADVANCED COMPUTING</h4>
    </div>
</div>

<label>Class:</label>
<select id="class">
<option>FYBSc CS AIML</option>
<option>SYBSc CS AIML</option>
<option>TYBSc CS AIML</option>
<option>FYBSc CS CTIS</option>
<option>SYBSc CS CTIS</option>
<option>TYBSc CS CTIS</option>
<option>FYMSc CS</option>
<option>SYMSc CS</option>
<option>FYMSc CS (CYBER)</option>
<option>SYMSc CS (CYBER)</option>
</select>

<label>Semester:</label>
<select id="semester">
<option>I</option><option>II</option><option>III</option>
<option>IV</option><option>V</option><option>VI</option>
</select>

<label>Subject Name:</label>
<input type="text" id="subject">

<label>Questions (one per line):</label>
<textarea id="questions" rows="6"></textarea>

<div class="actions">
<button onclick="openPreview()">Preview</button>
<button onclick="downloadWord()">Download Word</button>
</div>

</div>

<!-- PREVIEW MODAL -->
<div class="modal" id="previewModal">
<div class="modal-box">
<div class="modal-actions">
    <button onclick="downloadPDF()">Download PDF</button>
    <button onclick="printPaper()">Print</button>
    <button onclick="closePreview()">Close</button>
</div>
<iframe id="previewFrame"></iframe>
</div>
</div>

<script>
function buildHTML(){
    const cls=document.getElementById("class").value;
    const sem=document.getElementById("semester").value;
    const subject=document.getElementById("subject").value.trim();
    const qs=document.getElementById("questions").value
        .split(/\r?\n/).map(q=>q.trim()).filter(q=>q);

    if(!subject || qs.length<2){
        alert("Enter subject name and at least two questions.");
        return null;
    }

    let html=`<html><body style="font-family:'Times New Roman';font-size:12pt;font-weight:bold;">`;

    for(let i=0;i<qs.length;i++){
    for(let j=i+1;j<qs.length;j++){

html+=`
<table width="100%" cellpadding="6" cellspacing="0">
<tr>
<td colspan="3" align="center">
<b>
NAGINDAS KHANDWALA COLLEGE, MALAD(W)<br>
(Empowered Autonomous)<br><br>
${cls} SEM ${sem} PRACTICAL EXAMINATION FEBRUARY- 2026
</b>
</td>
</tr>

<tr>
<td colspan="3">
<table width="100%">
<tr>
<td align="left">Time: 2 Hours</td>
<td align="right">Roll No: __________</td>
</tr>
</table>
</td>
</tr>

<tr>
<td colspan="3">
<table width="100%">
<tr>
<td align="left">Course: ${subject}</td>
<td align="right">Marks: 50</td>
</tr>
</table>
</td>
</tr>

<tr>
<td width="60" align="center">Q1</td>
<td>${qs[i]}</td>
<td width="60" align="center">20</td>
</tr>

<tr>
<td align="center">Q2</td>
<td>${qs[j]}</td>
<td align="center">20</td>
</tr>

<tr>
<td align="center">Q3</td>
<td>VIVA</td>
<td align="center">05</td>
</tr>

<tr>
<td align="center">Q4</td>
<td>JOURNAL</td>
<td align="center">05</td>
</tr>
</table>
<br><br><br>`;
}}

html+=`</body></html>`;
return html;
}

function openPreview(){
    const html=buildHTML();
    if(!html) return;
    document.getElementById("previewFrame").srcdoc=html;
    document.getElementById("previewModal").style.display="block";
}

function closePreview(){
    document.getElementById("previewModal").style.display="none";
}

function downloadWord(){
    const html=buildHTML();
    if(!html) return;
    const blob=new Blob([html],{type:"text/html"});
    const a=document.createElement("a");
    a.href=URL.createObjectURL(blob);
    a.download=document.getElementById("subject").value+".doc";
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
}

function printPaper(){
    const html=buildHTML();
    const w=window.open("");
    w.document.write(html);
    w.document.close();
    w.print();
}

function downloadPDF(){
    printPaper(); // Save as PDF via print dialog
}
</script>

</body>
</html>


